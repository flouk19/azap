<div ng-if="$ctrl.currentUser && $ctrl.runningVote" class="vote-form">
    <button class="delete u-cf" ng-click="$ctrl.finishVote($ctrl.runningVote.vote)" ng-show="$ctrl.currentUser._id==$ctrl.runningVote.vote.owner"> &times;</button>
    <h4><strong>{{$ctrl.runningVote.vote.username}}</strong> wants to order at <strong>{{$ctrl.runningVote.restaurant.name}}</strong></h4>
    <form ng-if="!$ctrl.voteOwner && !$ctrl.voteAnswered"
        ng-submit="$ctrl.respondVote($ctrl.responseVal, $ctrl.runningVote)">
        <h6 class="subtitle">You too?</h6>
        <div class="u-full-width">
            <label>
                <input type="radio" ng-model="$ctrl.responseVal" ng-value="$ctrl.positive"/>
                <span class="label-body">Yes</span>
            </label>
        </div>
        <div class="u-full-width">
            <label>
                <input type="radio" ng-model="$ctrl.responseVal" ng-value="$ctrl.negative" />
                <span class="label-body">No</span>
            </label>
        </div>
        <div class="u-full-width" ng-if="$ctrl.runningVote.vote.allowSuggestions">
            <!-- only show this if the guy who asks wants to allow it -->
            <label>
                <input type="radio" ng-model="$ctrl.responseVal" ng-value="$ctrl.other"/>
                <span class="label-body">
                    Other <input type="text" ng-model="$ctrl.responseVal.restaurant"
                                ng-disabled="$ctrl.responseVal!==$ctrl.other"
                                ng-required="$ctrl.responseVal===$ctrl.other" />
                </span>
            </label>
        </div>
        <input type="submit" class="button-primary" value="Vote"/>
    </form>
    <div ng-if="$ctrl.voteOwner || $ctrl.voteAnswered">

        <div ng-hide="$ctrl.isNoVote($ctrl.voteResults)">
            <span>
                Look at the votes! <strong>{{$ctrl.voteResults[0] + $ctrl.voteResults[1]}} folks</strong> voted already
            </span>
            <canvas class="chart chart-doughnut" chart-data="$ctrl.voteResults"
            chart-colors="colors" chart-labels="labels" height="100px"></canvas>
            <div>
                <span>
                These guys are positive, <strong>{{$ctrl.runningVote.restaurant.name}}</strong>-positive
                </span>
                <ul>
                    <li ng-repeat="res in $ctrl.posVoteResponses" >
                        {{res.username}}
                    </li>
                </ul>
            </div>
            <div>
                <span>
                And these guys don't like the idea
                </span>
                <ul>
                    <li ng-repeat="res in $ctrl.negVoteResponses">
                        {{res.username}}
                    </li>
                </ul>
            </div>
            <div class="results-per-restaurant" ng-repeat="(restaurant, responses) in $ctrl.otherVoteResponses | groupBy: 'restaurant'">
                <span>These guys want to order at <strong>{{restaurant}}</strong></span>
                <ul>
                    <li ng-repeat="res in responses">
                        {{ res.username }}
                    </li>
                </ul>
            </div>


        </div>
        <span ng-show="$ctrl.isNoVote($ctrl.voteResults)">
            No votes so far, better wait for another minute
        </span>

    </div>

</div>
